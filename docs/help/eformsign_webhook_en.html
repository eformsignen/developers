<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>Using eformsign Webhook</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../_static/code-tabs.css" type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/code-tabs.js"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="prev" title="Using eformsign API" href="eformsign_api_en.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <img class="logo" src="../_static/forcs.png" alt="doit logo"/>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#eformsign-api-webhook-guide">eformsign api / webhook guide</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="eformsign_api_overview_en.html" class="reference internal ">Overview</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="eformsign_embedding_en.html" class="reference internal ">Embedding eformsign features</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="eformsign_api_en.html" class="reference internal ">Using eformsign API</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Using eformsign Webhook</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#getting-started" class="reference internal">Getting started</a></li>
                
                  <li class="toctree-l2"><a href="#generating-a-signature" class="reference internal">Generating a signature</a></li>
                
                  <li class="toctree-l2"><a href="#webhook-list" class="reference internal">Webhook list</a></li>
                
                  <li class="toctree-l2"><a href="#webhook-events" class="reference internal">Webhook events</a></li>
                
              </ul>
            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>Using eformsign Webhook</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="eformsign_api_en.html"
       title="previous chapter">← Using eformsign API</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <div class="section" id="using-eformsign-webhook">
<h1>Using eformsign Webhook<a class="headerlink" href="#using-eformsign-webhook" title="Permalink to this headline">¶</a></h1>
<p>This is a feature that sends event information to the customer’s system/service when an event occurs in eformsign. By configuring Webhook, event information is sent to the customer’s webhook endpoint in the HTTP POST method.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A Webhook endpoint refers to the customer’s client callback URL. It allows you to get eformsign event information without making unnecessary calls, which differs from the Open API method where calls are continuously made to check for changes (polling).</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-a-webhook-key">
<span id="webhook"></span><h3>Getting a Webhook key<a class="headerlink" href="#getting-a-webhook-key" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Log in to eformsign as the company administrator and then go to <strong>[Integration] &gt; [API / Webhook]</strong> in the sidebar menu.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/apikey1.PNG"><img alt="Integration &gt; API/Webhook menu" src="../_images/apikey1.PNG" style="width: 700px;" /></a>
<ol class="arabic simple" start="2">
<li><p>Select the <strong>[Manage Webhook]</strong> tab and then click the <strong>New Webhook</strong> button.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/webhook2.PNG"><img alt="New Webhook button" src="../_images/webhook2.PNG" style="width: 700px;" /></a>
<ol class="arabic simple" start="3">
<li><p>In the New Webhook pop-up, enter the Name, URL, and the List of affected templates, and make sure that the status is in enabled status. Then, click the <strong>Register</strong> button.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/webhook3.PNG"><img alt="New Webhook pop-up" src="../_images/webhook3.PNG" style="width: 700px;" /></a>
<ol class="arabic simple" start="4">
<li><p>Click the <strong>View key</strong> button in the Webhook list to view the Webhook public key.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/webhook4.PNG"><img alt="Webhook View key button" src="../_images/webhook4.PNG" style="width: 700px;" /></a>
<a class="reference internal image-reference" href="../_images/webhook5.PNG"><img alt="View key" src="../_images/webhook5.PNG" style="width: 700px;" /></a>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>If you click the <strong>Regenerate key</strong> button, the Webhook public key will be issued to you again and you will not be able to use the previous key.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Editing Webhook information</strong></p>
<p>You can change the information of a Webhook by clicking the <strong>Edit</strong> button in the Webhook list.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Deleting a Webhook</strong></p>
<p>You can delete a Webhook by clicking the <strong>Delete</strong> button in the Webhook list.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>Click the <strong>Test</strong> button in the Webhook list to send a test Webhook and get the returned results.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/webhook6.PNG"><img alt="Webhook Test" src="../_images/webhook6.PNG" style="width: 700px;" /></a>
<p>The following is a json file used for testing purposes.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>{
&quot;webhook_id&quot; : &quot;Webhook ID&quot;,
&quot;webhook_name&quot; : &quot;Webhook name&quot;,
&quot;company_id&quot; : &quot;company ID&quot;,
&quot;event_type&quot; : “document”,
&quot;document&quot; : {
  &quot;id&quot; : “test_doc_id”,
   &quot;template_id&quot; : “test_template_id”,
   &quot;template_version&quot; : “1”,
   &quot;document_history_id&quot; : “test_document_history_id”,
   &quot;doc_status&quot; : “doc_create”,
   &quot;editor_id&quot; : &quot;user ID&quot;,
   &quot;updated_date&quot; : &quot;current time(UTC Long)&quot;
}
}
Test URL : Webhook URL
</pre></div>
</div>
</div>
</div>
<div class="section" id="generating-a-signature">
<h2>Generating a signature<a class="headerlink" href="#generating-a-signature" title="Permalink to this headline">¶</a></h2>
<p>The following describes how to generate a signature for each language: Java, Python, and PHP.</p>
<div class="section" id="java">
<h3>Java<a class="headerlink" href="#java" title="Permalink to this headline">¶</a></h3>
<p>Check the event information received from the eformsign server by using the public key issued to you in <a class="reference external" href="#webhook">Getting a Webhook Key</a> to verify whether the event was called normally from eformsign.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The signature algorithm used is SHA256withECDSA.</p>
</div>
</div>
<div class="section" id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h3>
<p>Use the library for key generation in the link below. Install the library using the following command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">warner</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">ecdsa</span><span class="o">/</span><span class="n">archive</span><span class="o">/</span><span class="n">master</span><span class="o">.</span><span class="n">zip</span>
</pre></div>
</div>
</div>
<div class="section" id="php">
<h3>PHP<a class="headerlink" href="#php" title="Permalink to this headline">¶</a></h3>
<p>Make sure that the keycheck.inc.php and test.php files in the following examples are located in the same path before proceeding.</p>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>The following shows the examples for each language.</p>
<div class="code-tabs docutils container">
<div class="code-tab" data-title="Java">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.*</span><span class="p">;</span>
        <span class="kn">import</span> <span class="nn">java.math.BigInteger</span><span class="p">;</span>
        <span class="kn">import</span> <span class="nn">java.security.*</span><span class="p">;</span>
        <span class="kn">import</span> <span class="nn">java.security.spec.X509EncodedKeySpec</span><span class="p">;</span>

        <span class="p">....</span>
        <span class="cm">/**</span>
<span class="cm">         *  Reads the header and body in the request.</span>
<span class="cm">         *</span>
<span class="cm">         */</span>


        <span class="c1">//1. get eformsign signature</span>
        <span class="c1">//eformsignSignature is contained in the request header.</span>
        <span class="n">String</span> <span class="n">eformsignSignature</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="na">getHeader</span><span class="p">(</span><span class="s">&quot;eformsign_signature&quot;</span><span class="p">);</span>


        <span class="c1">//2. get request body data</span>
        <span class="c1">// Converts the data in the body to string to verify the eformsign signature.</span>
        <span class="n">String</span> <span class="n">eformsignEventBody</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="p">();</span>
        <span class="n">BufferedReader</span> <span class="n">bufferedReader</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">try</span> <span class="p">{</span>
            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">inputStream</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">bufferedReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="p">(</span><span class="n">inputStream</span><span class="p">));</span>
                <span class="kt">char</span><span class="o">[]</span> <span class="n">charBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="mi">128</span><span class="o">]</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">bytesRead</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="k">while</span> <span class="p">((</span><span class="n">bytesRead</span> <span class="o">=</span> <span class="n">bufferedReader</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">charBuffer</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">stringBuilder</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">charBuffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bytesRead</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="n">ex</span><span class="p">;</span>
         <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bufferedReader</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="n">bufferedReader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="n">ex</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">}</span>
        <span class="n">eformsignEventBody</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>




        <span class="c1">//3. publicKey configuration</span>
        <span class="n">String</span> <span class="n">publicKeyHex</span> <span class="o">=</span> <span class="s">&quot;the issued Public Key(String)&quot;</span><span class="p">;</span>
        <span class="n">KeyFactory</span> <span class="n">publicKeyFact</span> <span class="o">=</span> <span class="n">KeyFactory</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;EC&quot;</span><span class="p">);</span>
        <span class="n">X509EncodedKeySpec</span> <span class="n">x509KeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">X509EncodedKeySpec</span><span class="p">(</span><span class="k">new</span> <span class="n">BigInteger</span><span class="p">(</span><span class="n">publicKeyHex</span><span class="p">,</span><span class="mi">16</span><span class="p">).</span><span class="na">toByteArray</span><span class="p">());</span>
        <span class="n">PublicKey</span> <span class="n">publicKey</span> <span class="o">=</span> <span class="n">publicKeyFact</span><span class="p">.</span><span class="na">generatePublic</span><span class="p">(</span><span class="n">x509KeySpec</span><span class="p">);</span>

        <span class="c1">//4. verify</span>
        <span class="n">Signature</span> <span class="n">signature</span> <span class="o">=</span> <span class="n">Signature</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;SHA256withECDSA&quot;</span><span class="p">);</span>
        <span class="n">signature</span><span class="p">.</span><span class="na">initVerify</span><span class="p">(</span><span class="n">publicKey</span><span class="p">);</span>
        <span class="n">signature</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">eformsignEventBody</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="n">signature</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="k">new</span> <span class="n">BigInteger</span><span class="p">(</span><span class="n">eformsignSignature</span><span class="p">,</span><span class="mi">16</span><span class="p">).</span><span class="na">toByteArray</span><span class="p">())){</span>
            <span class="c1">//verify success</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;verify success&quot;</span><span class="p">);</span>
            <span class="cm">/*</span>
<span class="cm">             *Events are handled here.</span>
<span class="cm">             */</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="c1">//verify fail</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;verify fail&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</div>
</div><div class="code-tab" data-title="Python">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>
        <span class="kn">import</span> <span class="nn">binascii</span>

        <span class="kn">from</span> <span class="nn">ecdsa</span> <span class="kn">import</span> <span class="n">VerifyingKey</span><span class="p">,</span> <span class="n">BadSignatureError</span>
        <span class="kn">from</span> <span class="nn">ecdsa.util</span> <span class="kn">import</span> <span class="n">sigencode_der</span><span class="p">,</span> <span class="n">sigdecode_der</span>
        <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>


        <span class="o">...</span>
        <span class="c1"># Reads the header and boy in the request.</span>
        <span class="c1"># 1. get eformsign signature</span>
        <span class="c1"># eformsignSignature is contained in the request header.</span>
        <span class="n">eformsignSignature</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;eformsign_signature&#39;</span><span class="p">]</span>


        <span class="c1"># 2. get request body data</span>
        <span class="c1"># Converts the data in the body to string to verify the eformsign signature.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>


        <span class="c1"># 3. publicKey configuration</span>
        <span class="n">publicKeyHex</span> <span class="o">=</span> <span class="s2">&quot;the issued public key&quot;</span>
        <span class="n">publickey</span> <span class="o">=</span> <span class="n">VerifyingKey</span><span class="o">.</span><span class="n">from_der</span><span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">publicKeyHex</span><span class="p">))</span>


        <span class="c1"># 4. verify</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">publickey</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">eformsignSignature</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">hashfunc</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">,</span> <span class="n">sigdecode</span><span class="o">=</span><span class="n">sigdecode_der</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;verify success&quot;</span><span class="p">)</span>
                <span class="c1"># Events are handled here.</span>
        <span class="k">except</span> <span class="n">BadSignatureError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;verify fail&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div class="code-tab" data-title="PHP - keycheck.inc.php">
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">eformsignECDSA</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">PublicKey</span>
<span class="p">{</span>

    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$pem_data</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">hex2bin</span><span class="p">(</span><span class="nv">$str</span><span class="p">));</span>
        <span class="nv">$offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$pem</span> <span class="o">=</span> <span class="s2">&quot;-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$offset</span> <span class="o">&lt;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$pem_data</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$pem</span> <span class="o">=</span> <span class="nv">$pem</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$pem_data</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="nv">$offset</span> <span class="o">=</span> <span class="nv">$offset</span> <span class="o">+</span> <span class="mi">64</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$pem</span> <span class="o">=</span> <span class="nv">$pem</span> <span class="o">.</span> <span class="s2">&quot;-----END PUBLIC KEY-----</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">openSslPublicKey</span> <span class="o">=</span> <span class="nb">openssl_get_publickey</span><span class="p">(</span><span class="nv">$pem</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">Verify</span><span class="p">(</span><span class="nv">$message</span><span class="p">,</span> <span class="nv">$signature</span><span class="p">,</span> <span class="nv">$publicKey</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">openssl_verify</span><span class="p">(</span><span class="nv">$message</span><span class="p">,</span> <span class="nv">$signature</span><span class="p">,</span> <span class="nv">$publicKey</span><span class="o">-&gt;</span><span class="na">openSslPublicKey</span><span class="p">,</span> <span class="nx">OPENSSL_ALGO_SHA256</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</div><div class="code-tab" data-title="PHP - test.php">
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/keycheck.inc.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">eformsignECDSA\PublicKey</span><span class="p">;</span>

<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;PUBLIC_KEY&#39;</span><span class="p">,</span> <span class="s1">&#39;input the issued public key.&#39;</span><span class="p">);</span>
<span class="o">...</span>
<span class="cm">/*</span>
<span class="cm"> *  Reads the header and body in the request.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>


<span class="c1">//1. get eformsign signature</span>
<span class="c1">//eformsignSignature is contained in the request header.</span>
<span class="nv">$eformsignSignature</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_eformsign_signature&#39;</span><span class="p">];</span>


<span class="c1">//2. get request body data</span>
<span class="c1">// Reads the data in the body to verify the eformsign signature.</span>
<span class="nv">$eformsignEventBody</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">),</span> <span class="k">true</span><span class="p">);</span>


<span class="c1">//3. publicKey configuration</span>
<span class="nv">$publicKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PublicKey</span><span class="p">(</span><span class="nx">PUBLIC_KEY</span><span class="p">);</span>


<span class="c1">//4. verify</span>
<span class="nv">$ret</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="nv">$ret</span> <span class="o">=</span> <span class="nx">eformsignECDSA\Verify</span><span class="p">(</span><span class="nx">MESSAGE</span><span class="p">,</span> <span class="nv">$eformsignSignature</span><span class="p">,</span> <span class="nv">$publicKey</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$ret</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s1">&#39;verify success&#39;</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
    <span class="cm">/*</span>
<span class="cm">     * Events are handled here.</span>
<span class="cm">     */</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s1">&#39;verify fail&#39;</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
<span class="p">}</span>
 <span class="o">...</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</div></div>
</div>
</div>
<div class="section" id="webhook-list">
<h2>Webhook list<a class="headerlink" href="#webhook-list" title="Permalink to this headline">¶</a></h2>
<p>By configuring the following Webhook, you can receive the information in the webhook endpoint when the configured event occurs in eformsign.</p>
<p>The following is <a class="reference external" href="https://app.swaggerhub.com/apis/eformsign_api/eformsign_API_2.0/Webhook">Webhook</a> provided in eformsign.</p>
<p><code class="docutils literal notranslate"><span class="pre">POST</span></code>: <a class="reference external" href="https://app.swaggerhub.com/apis/eformsign_api/eformsign_API_2.0/Webhook#/default/post-webhook-document-event">/webhook document event</a> Send document events</p>
<p><code class="docutils literal notranslate"><span class="pre">POST</span></code>: <a class="reference external" href="https://app.swaggerhub.com/apis/eformsign_api/eformsign_API_2.0/Webhook#/default/post-webhook-pdf">/webhook pdf</a> Send PDF generation events</p>
<p>Click
<a class="reference external" href="https://app.swaggerhub.com/apis/eformsign_api/eformsign_API_2.0/Webhook">here</a> for more information about each eformsign Webhook.</p>
</div>
<div class="section" id="webhook-events">
<h2>Webhook events<a class="headerlink" href="#webhook-events" title="Permalink to this headline">¶</a></h2>
<p>eformsign provides <strong>document</strong> events and <strong>PDF generation</strong> events as Webhook events.</p>
<div class="section" id="document-events">
<h3>Document events<a class="headerlink" href="#document-events" title="Permalink to this headline">¶</a></h3>
<p>This event occurs when a document is created or the status of a document is changed in eformsign.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 14%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>String</p></td>
<td><p>Document ID</p></td>
</tr>
<tr class="row-odd"><td><p>template_id</p></td>
<td><p>String</p></td>
<td><p>Template ID</p></td>
</tr>
<tr class="row-even"><td><p>template_name</p></td>
<td><p>String</p></td>
<td><p>Template name</p></td>
</tr>
<tr class="row-odd"><td><p>template_version</p></td>
<td><p>String</p></td>
<td><p>Template title</p></td>
</tr>
<tr class="row-even"><td><p>workflow_seq</p></td>
<td><p>int</p></td>
<td><p>Workflow order</p></td>
</tr>
<tr class="row-odd"><td><p>workflow_name</p></td>
<td><p>String</p></td>
<td><p>Workflow name</p></td>
</tr>
<tr class="row-even"><td><p>history_id</p></td>
<td><p>String</p></td>
<td><p>Document history ID</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>String</p></td>
<td><p>Document status</p></td>
</tr>
<tr class="row-even"><td><p>editor_id</p></td>
<td><p>String</p></td>
<td><p>Creator ID</p></td>
</tr>
<tr class="row-odd"><td><p>updated_date</p></td>
<td><p>long</p></td>
<td><p>Document update time</p></td>
</tr>
</tbody>
</table>
<p>Refer to the following for the meaning of each document status in event data.</p>
<table class="docutils align-default" id="status">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>doc_create</p></td>
<td><p>Document created</p></td>
</tr>
<tr class="row-odd"><td><p>doc_tempsave</p></td>
<td><p>Document saved as a draft</p></td>
</tr>
<tr class="row-even"><td><p>doc_request_approval</p></td>
<td><p>Document approval requested</p></td>
</tr>
<tr class="row-odd"><td><p>doc_accept_approval</p></td>
<td><p>Document approval request approved</p></td>
</tr>
<tr class="row-even"><td><p>doc_reject_approval</p></td>
<td><p>Document approval request declined</p></td>
</tr>
<tr class="row-odd"><td><p>doc_request_external</p></td>
<td><p>Document sent to external recipient</p></td>
</tr>
<tr class="row-even"><td><p>doc_remind_external</p></td>
<td><p>Document resent to external recipient</p></td>
</tr>
<tr class="row-odd"><td><p>doc_open_external</p></td>
<td><p>Document opened by external recipient</p></td>
</tr>
<tr class="row-even"><td><p>doc_accept_external</p></td>
<td><p>Document reviewed by external recipient</p></td>
</tr>
<tr class="row-odd"><td><p>doc_reject_external</p></td>
<td><p>Document declined by external recipient</p></td>
</tr>
<tr class="row-even"><td><p>doc_request_internal</p></td>
<td><p>Document sent to internal recipient</p></td>
</tr>
<tr class="row-odd"><td><p>doc_accept_internal</p></td>
<td><p>Document reviewed by internal recipient</p></td>
</tr>
<tr class="row-even"><td><p>doc_reject_internal</p></td>
<td><p>Document declined by internal recipient</p></td>
</tr>
<tr class="row-odd"><td><p>doc_tempsave_internal</p></td>
<td><p>Document saved as a draft by internal recipient</p></td>
</tr>
<tr class="row-even"><td><p>doc_cancel_request</p></td>
<td><p>Document approval request cancelled</p></td>
</tr>
<tr class="row-odd"><td><p>doc_reject_request</p></td>
<td><p>Document requested to be declined</p></td>
</tr>
<tr class="row-even"><td><p>doc_decline_cancel_request</p></td>
<td><p>Document decline request rejected</p></td>
</tr>
<tr class="row-odd"><td><p>doc_delete_request</p></td>
<td><p>Document requested to be deleted</p></td>
</tr>
<tr class="row-even"><td><p>doc_decline_delete_request</p></td>
<td><p>Document deletion request rejected</p></td>
</tr>
<tr class="row-odd"><td><p>doc_deleted</p></td>
<td><p>Document deleted</p></td>
</tr>
<tr class="row-even"><td><p>doc_complete</p></td>
<td><p>Document completed</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pdf-generation-events">
<h3>PDF generation events<a class="headerlink" href="#pdf-generation-events" title="Permalink to this headline">¶</a></h3>
<p>The following is a list of events generated when the PDF file of a document is created in eformsign.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 46%" />
<col style="width: 13%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>document_id</p></td>
<td><p>String</p></td>
<td><p>Document ID</p></td>
</tr>
<tr class="row-odd"><td><p>template_id</p></td>
<td><p>String</p></td>
<td><p>Template ID</p></td>
</tr>
<tr class="row-even"><td><p>template_name</p></td>
<td><p>String</p></td>
<td><p>Template name</p></td>
</tr>
<tr class="row-odd"><td><p>template_version</p></td>
<td><p>String</p></td>
<td><p>Template title</p></td>
</tr>
<tr class="row-even"><td><p>workflow_seq</p></td>
<td><p>int</p></td>
<td><p>Workflow order</p></td>
</tr>
<tr class="row-odd"><td><p>workflow_name</p></td>
<td><p>String</p></td>
<td><p>Workflow name</p></td>
</tr>
<tr class="row-even"><td><p>document_history_id</p></td>
<td><p>String</p></td>
<td><p>Document history ID</p></td>
</tr>
<tr class="row-odd"><td><p>document_status</p></td>
<td><p>String</p></td>
<td><p>Document status</p></td>
</tr>
</tbody>
</table>
<p>For the meaning of each document status in event data, refer to <a class="reference external" href="#status">the document status section</a>.</p>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="eformsign_api_en.html"
       title="previous chapter">← Using eformsign API</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2021. FORCS CO., LTD. All rights reserved.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.1 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>